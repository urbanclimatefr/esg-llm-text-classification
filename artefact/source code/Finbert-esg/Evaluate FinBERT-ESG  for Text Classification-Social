{"metadata":{"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python","version":"3.10.12","mimetype":"text/x-python","codemirror_mode":{"name":"ipython","version":3},"pygments_lexer":"ipython3","nbconvert_exporter":"python","file_extension":".py"},"kaggle":{"accelerator":"gpu","dataSources":[{"sourceId":1192499,"sourceType":"datasetVersion","datasetId":622510},{"sourceId":4295,"sourceType":"modelInstanceVersion","modelInstanceId":3090}],"dockerImageVersionId":30558,"isInternetEnabled":false,"language":"python","sourceType":"notebook","isGpuEnabled":true},"colab":{"provenance":[{"file_id":"1L3pPCd8ZvAUShey4YMi1iuO17HEwDM2Q","timestamp":1714337391262},{"file_id":"https://storage.googleapis.com/kaggle-colab-exported-notebooks/fine-tune-llama-2-for-sentiment-analysis-0b3bc634-17a8-440c-987c-ef532b3e1a94.ipynb?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com/20240428/auto/storage/goog4_request&X-Goog-Date=20240428T151907Z&X-Goog-Expires=259200&X-Goog-SignedHeaders=host&X-Goog-Signature=0d1c4f9d4ac1aa60c4b133a1b651c46b74cf0a71648ffe2c6619b6da7210df275f71da00e7481c1bd781a60e4ac90856230806cba8fa92fc8c0749bacf4014768ffa7ba7ff1e8e3c8a36debb6a63cd349871e75f0ac2aa4e700a72453284791707fc691d9c7d7f2cf59b74a4cf186fdd439d096a15ca89577a0c5384423c39d77ec60202c059f1cd32597cb9974953aa07b1f3230e8a6438044bbd1d694396c7c74e696906fbec420b91322e10764ae0b64d989753d67a381f589f8eadecc8b56a913a77efac2cc687720b68ea225c64f697fc1a2e6518d4296f142188faa3b35ea8ae62fcf2419f64fe12842bb8c125bdbc2dcd0216efa827509f3f2a125c3b","timestamp":1714317558194}],"machine_shape":"hm","gpuType":"L4"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"86bceebc724642fdb3c4a528df349d33":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a2111333cb3b40a1821a434d9e85ad2a","IPY_MODEL_04be0e2e0c564b8c96a54b40c22e71d5","IPY_MODEL_2f29e8e7b440431fb26ab1a9e24b6ed5"],"layout":"IPY_MODEL_ce6c71662fe542c8971ff7afb7e2d7dc"}},"a2111333cb3b40a1821a434d9e85ad2a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_252fb06422d14770b53eb98d9e4dd947","placeholder":"​","style":"IPY_MODEL_f9fb2c9231bb4cfc9f12ccadd48ccc62","value":"config.json: 100%"}},"04be0e2e0c564b8c96a54b40c22e71d5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_79a29abc150547e5a9f6340ebabad781","max":781,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6c6a3aa66c514425be373db152b9ffab","value":781}},"2f29e8e7b440431fb26ab1a9e24b6ed5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_89c97452dd0249b4a629ca0aaa83ce8e","placeholder":"​","style":"IPY_MODEL_5f67639be6194b3e925a49baff13ea55","value":" 781/781 [00:00&lt;00:00, 68.1kB/s]"}},"ce6c71662fe542c8971ff7afb7e2d7dc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"252fb06422d14770b53eb98d9e4dd947":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f9fb2c9231bb4cfc9f12ccadd48ccc62":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"79a29abc150547e5a9f6340ebabad781":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6c6a3aa66c514425be373db152b9ffab":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"89c97452dd0249b4a629ca0aaa83ce8e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5f67639be6194b3e925a49baff13ea55":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cec02e7e68a34ba29f596bbb3acc9216":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3c73341782cd4c7691b084067e3ff7a4","IPY_MODEL_a0cd85fb0e0148d196281a81876a20bf","IPY_MODEL_88aa598240e34a97bf3ffa234c875b84"],"layout":"IPY_MODEL_9f5d60b4a9d646e28fe6eebe2f87275a"}},"3c73341782cd4c7691b084067e3ff7a4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d150de202de1480f826ba595d0a50c48","placeholder":"​","style":"IPY_MODEL_03784080fd6f4bc1bf48d20fa4e84d31","value":"pytorch_model.bin: 100%"}},"a0cd85fb0e0148d196281a81876a20bf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0d7e8c01898d418b82c6b92e40fb1cc3","max":439107090,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f1f8eec1a55e4faeb8c364295f316f9c","value":439107090}},"88aa598240e34a97bf3ffa234c875b84":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c8f9763ecdb94812ba842849f35e9760","placeholder":"​","style":"IPY_MODEL_030cdecb32554688852f97fdc9ea4806","value":" 439M/439M [00:02&lt;00:00, 191MB/s]"}},"9f5d60b4a9d646e28fe6eebe2f87275a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d150de202de1480f826ba595d0a50c48":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"03784080fd6f4bc1bf48d20fa4e84d31":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0d7e8c01898d418b82c6b92e40fb1cc3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f1f8eec1a55e4faeb8c364295f316f9c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c8f9763ecdb94812ba842849f35e9760":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"030cdecb32554688852f97fdc9ea4806":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"60412776b9ce4194a0565a2bf9bda03f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_282ffd7f301245ce8dde3c7e86db0ce1","IPY_MODEL_99436497a509436bab210dc01a29c192","IPY_MODEL_2634c818272f4e85b61ae17dfb125429"],"layout":"IPY_MODEL_bb6f9113ddae4a75b47289463c7992e4"}},"282ffd7f301245ce8dde3c7e86db0ce1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_630a67312b7e4fdc99fc8d2efb391d65","placeholder":"​","style":"IPY_MODEL_10db8c5d400340b393c183943a9e96ca","value":"vocab.txt: 100%"}},"99436497a509436bab210dc01a29c192":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b7efc26d7428435da0506c51ee07aab2","max":226122,"min":0,"orientation":"horizontal","style":"IPY_MODEL_be40fad6588c4f22892ca7a2e9de5746","value":226122}},"2634c818272f4e85b61ae17dfb125429":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6836ee096e5942be8158cea380f0625e","placeholder":"​","style":"IPY_MODEL_2de91c44ddce4d96be2e9bbf6464e4ac","value":" 226k/226k [00:00&lt;00:00, 7.15MB/s]"}},"bb6f9113ddae4a75b47289463c7992e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"630a67312b7e4fdc99fc8d2efb391d65":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"10db8c5d400340b393c183943a9e96ca":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b7efc26d7428435da0506c51ee07aab2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"be40fad6588c4f22892ca7a2e9de5746":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6836ee096e5942be8158cea380f0625e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2de91c44ddce4d96be2e9bbf6464e4ac":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat_minor":0,"nbformat":4,"cells":[{"cell_type":"markdown","source":["## Installations and imports"],"metadata":{"id":"UB8_ZM31SetP"}},{"cell_type":"code","source":["!pip install -q -U \"torch==2.1.2\""],"metadata":{"execution":{"iopub.status.busy":"2024-04-26T15:46:51.533318Z","iopub.execute_input":"2024-04-26T15:46:51.534112Z","iopub.status.idle":"2024-04-26T15:51:44.001564Z","shell.execute_reply.started":"2024-04-26T15:46:51.534058Z","shell.execute_reply":"2024-04-26T15:51:43.999504Z"},"trusted":true,"id":"5YeGTE9DSetP","executionInfo":{"status":"ok","timestamp":1714337606297,"user_tz":240,"elapsed":98956,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"6bf9a31d-3bbc-4597-cef4-c40c15fb0393"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m209.8/209.8 MB\u001b[0m \u001b[31m3.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m89.2/89.2 MB\u001b[0m \u001b[31m18.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","torchaudio 2.2.1+cu121 requires torch==2.2.1, but you have torch 2.1.2 which is incompatible.\n","torchtext 0.17.1 requires torch==2.2.1, but you have torch 2.1.2 which is incompatible.\n","torchvision 0.17.1+cu121 requires torch==2.2.1, but you have torch 2.1.2 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0m"]}]},{"cell_type":"code","source":["!pip install -q -U \"transformers==4.36.2\" \"datasets==2.16.1\" \"accelerate==0.26.1\""],"metadata":{"execution":{"iopub.status.busy":"2024-04-26T16:04:55.495375Z","iopub.execute_input":"2024-04-26T16:04:55.496049Z","iopub.status.idle":"2024-04-26T16:07:25.513833Z","shell.execute_reply.started":"2024-04-26T16:04:55.49599Z","shell.execute_reply":"2024-04-26T16:07:25.512145Z"},"trusted":true,"id":"7zqMMe6RSetP","executionInfo":{"status":"ok","timestamp":1714337623562,"user_tz":240,"elapsed":17268,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"e4f7b55b-7e33-431a-c710-cbdf04900126"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/134.8 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m4.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h"]}]},{"cell_type":"markdown","source":["The code imports the os module and sets two environment variables:\n","* CUDA_VISIBLE_DEVICES: This environment variable tells PyTorch which GPUs to use. In this case, the code is setting the environment variable to 0, which means that PyTorch will use the first GPU.\n","* TOKENIZERS_PARALLELISM: This environment variable tells the Hugging Face Transformers library whether to parallelize the tokenization process. In this case, the code is setting the environment variable to false, which means that the tokenization process will not be parallelized."],"metadata":{"id":"WlDeAXzNSetQ"}},{"cell_type":"code","source":["import os\n","os.environ[\"CUDA_VISIBLE_DEVICES\"] = \"0\"\n","os.environ[\"TOKENIZERS_PARALLELISM\"] = \"false\""],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:32.894556Z","iopub.execute_input":"2024-02-19T15:22:32.894943Z","iopub.status.idle":"2024-02-19T15:22:32.900259Z","shell.execute_reply.started":"2024-02-19T15:22:32.894904Z","shell.execute_reply":"2024-02-19T15:22:32.899115Z"},"trusted":true,"id":"5FqZqYjRSetQ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["The code import warnings; warnings.filterwarnings(\"ignore\") imports the warnings module and sets the warning filter to ignore. This means that all warnings will be suppressed and will not be displayed. Actually during training there are many warnings that do not prevent the fine-tuning but can be distracting and make you wonder if you are doing the correct things."],"metadata":{"id":"7MDuK4_8SetQ"}},{"cell_type":"code","source":["import warnings\n","warnings.filterwarnings(\"ignore\")"],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:32.901507Z","iopub.execute_input":"2024-02-19T15:22:32.90177Z","iopub.status.idle":"2024-02-19T15:22:32.914498Z","shell.execute_reply.started":"2024-02-19T15:22:32.901747Z","shell.execute_reply":"2024-02-19T15:22:32.913622Z"},"trusted":true,"id":"4vEGNQQOSetQ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["In the following cell there are all the other imports for running the notebook"],"metadata":{"id":"e5tzXAWtSetQ"}},{"cell_type":"code","source":["import numpy as np\n","import pandas as pd\n","import os\n","from tqdm import tqdm\n","import torch\n","import torch.nn as nn\n","import transformers\n","from datasets import Dataset\n","from transformers import (AutoModelForCausalLM,\n","                          AutoTokenizer,\n","                          BitsAndBytesConfig,\n","                          TrainingArguments,\n","                          pipeline,\n","                          logging,\n","                          BertTokenizer,\n","                          BertForSequenceClassification\n","                          )\n","from sklearn.metrics import (accuracy_score,\n","                             classification_report,\n","                             confusion_matrix)\n","from sklearn.model_selection import train_test_split"],"metadata":{"papermill":{"duration":14.485002,"end_time":"2023-10-16T11:00:18.917449","exception":false,"start_time":"2023-10-16T11:00:04.432447","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-02-19T15:22:32.915638Z","iopub.execute_input":"2024-02-19T15:22:32.915866Z","iopub.status.idle":"2024-02-19T15:22:48.260443Z","shell.execute_reply.started":"2024-02-19T15:22:32.915846Z","shell.execute_reply":"2024-02-19T15:22:48.259636Z"},"trusted":true,"id":"I8rxnQuGSetR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# standard libraries\n","import matplotlib.pyplot as plt\n","from sklearn.metrics import ConfusionMatrixDisplay"],"metadata":{"id":"jFFZaFgzbpVn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(f\"pytorch version {torch.__version__}\")"],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:48.261986Z","iopub.execute_input":"2024-02-19T15:22:48.262366Z","iopub.status.idle":"2024-02-19T15:22:48.267436Z","shell.execute_reply.started":"2024-02-19T15:22:48.26233Z","shell.execute_reply":"2024-02-19T15:22:48.266395Z"},"trusted":true,"id":"3_jb0ZrUSetR","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1714337631856,"user_tz":240,"elapsed":18,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"5aa77785-e857-4eac-fa82-3b4090b4bd38"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["pytorch version 2.1.2+cu121\n"]}]},{"cell_type":"code","source":["device = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\n","print(f\"working on {device}\")"],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:48.268538Z","iopub.execute_input":"2024-02-19T15:22:48.26905Z","iopub.status.idle":"2024-02-19T15:22:48.284682Z","shell.execute_reply.started":"2024-02-19T15:22:48.268983Z","shell.execute_reply":"2024-02-19T15:22:48.283708Z"},"trusted":true,"id":"cydwCB0-SetR","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1714337631856,"user_tz":240,"elapsed":15,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"4f7005b2-220a-44f1-8cb9-ea57282b146f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["working on cuda:0\n"]}]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZmSErehrS7re","executionInfo":{"status":"ok","timestamp":1714337749630,"user_tz":240,"elapsed":117787,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"bced318c-4124-4f75-f4db-11fee3c6210c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"markdown","source":["## Preparing the data and the core evaluation functions"],"metadata":{"id":"U4-qApSpSetR"}},{"cell_type":"markdown","source":["The code in the next cell performs the following steps:\n","\n","1. Reads the input dataset from the s_2k.csv file, which is a comma-separated value (CSV) file with two columns: label and text.\n","2. Splits the dataset into training and test sets, with 250 samples in each set. The split is stratified by label, so that each set contains a representative sample of positive, neutral, and negative labels.\n","3. Shuffles the train data in a replicable order (random_state=10)\n","4. Transforms the texts contained in the train and test data into prompts to be used by Llama: the train prompts contains the expected answer we want to fine-tune the model with\n","5. The residual examples not in train or test, for reporting purposes during training (but it won't be used for early stopping), is treated as evaluation data, which is sampled with repetition in order to have a 50/50/50 sample (negative instances are very few, hence they should be repeated)\n","5. The train and eval data are wrapped by the class from Hugging Face (https://huggingface.co/docs/datasets/index)\n","\n","This prepares in a single cell train_data, eval_data and test_data datasets to be used in our fine tuning."],"metadata":{"id":"8fi5OMpiSetR"}},{"cell_type":"code","source":["filename = \"/content/drive/My Drive/Datasets/s_2k.csv\"\n","\n","df = pd.read_csv(filename,\n","                 encoding=\"utf-8\", encoding_errors=\"replace\")\n","# replace values\n","df.replace({'Not Social': 'negative', 'Social': 'positive'}, inplace=True)\n"],"metadata":{"id":"wRGvCIvYTA69"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X_train = list()\n","X_test = list()\n","for label in [\"positive\", \"negative\"]:\n","    train, test  = train_test_split(df[df.label==label],\n","                                    train_size=250,\n","                                    test_size=250,\n","                                    random_state=42)\n","    X_train.append(train)\n","    X_test.append(test)\n","\n","X_train = pd.concat(X_train).sample(frac=1, random_state=10)\n","X_test = pd.concat(X_test)\n","\n","eval_idx = [idx for idx in df.index if idx not in list(X_train.index) + list(X_test.index)]\n","X_eval = df[df.index.isin(eval_idx)]\n","X_eval = (X_eval\n","          .groupby('label', group_keys=False)\n","          .apply(lambda x: x.sample(n=50, random_state=10, replace=True)))\n","X_train = X_train.reset_index(drop=True)\n","\n","y_true = X_test.label\n","\n","train_data = Dataset.from_pandas(X_train)\n","eval_data = Dataset.from_pandas(X_eval)"],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:48.28578Z","iopub.execute_input":"2024-02-19T15:22:48.286089Z","iopub.status.idle":"2024-02-19T15:22:48.802257Z","shell.execute_reply.started":"2024-02-19T15:22:48.286056Z","shell.execute_reply":"2024-02-19T15:22:48.80152Z"},"trusted":true,"id":"MKzrGSR0SetR"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Testing the model without fine-tuning"],"metadata":{"id":"66yPJ9CrSetS"}},{"cell_type":"code","source":["!huggingface-cli login"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zSJ21qeQT1tS","executionInfo":{"status":"ok","timestamp":1714337767196,"user_tz":240,"elapsed":16346,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"963686d3-7ba0-4e3f-c577-527f4f9957e3"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|\n","    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|\n","    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|\n","    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|\n","    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|\n","\n","    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .\n","Token: \n","Add token as git credential? (Y/n) Y\n","Token is valid (permission: write).\n","\u001b[1m\u001b[31mCannot authenticate through git-credential as no helper is defined on your machine.\n","You might have to re-authenticate when pushing to the Hugging Face Hub.\n","Run the following command in your terminal in case you want to set the 'store' credential helper as default.\n","\n","git config --global credential.helper store\n","\n","Read https://git-scm.com/book/en/v2/Git-Tools-Credential-Storage for more details.\u001b[0m\n","Token has not been saved to git credential helper.\n","Your token has been saved to /root/.cache/huggingface/token\n","Login successful\n"]}]},{"cell_type":"code","source":["# Load model from Hugging Face Hub with model name and bitsandbytes configuration\n","\n","model = BertForSequenceClassification.from_pretrained('yiyanghkust/finbert-esg',num_labels=4)\n","tokenizer = BertTokenizer.from_pretrained('yiyanghkust/finbert-esg')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["86bceebc724642fdb3c4a528df349d33","a2111333cb3b40a1821a434d9e85ad2a","04be0e2e0c564b8c96a54b40c22e71d5","2f29e8e7b440431fb26ab1a9e24b6ed5","ce6c71662fe542c8971ff7afb7e2d7dc","252fb06422d14770b53eb98d9e4dd947","f9fb2c9231bb4cfc9f12ccadd48ccc62","79a29abc150547e5a9f6340ebabad781","6c6a3aa66c514425be373db152b9ffab","89c97452dd0249b4a629ca0aaa83ce8e","5f67639be6194b3e925a49baff13ea55","cec02e7e68a34ba29f596bbb3acc9216","3c73341782cd4c7691b084067e3ff7a4","a0cd85fb0e0148d196281a81876a20bf","88aa598240e34a97bf3ffa234c875b84","9f5d60b4a9d646e28fe6eebe2f87275a","d150de202de1480f826ba595d0a50c48","03784080fd6f4bc1bf48d20fa4e84d31","0d7e8c01898d418b82c6b92e40fb1cc3","f1f8eec1a55e4faeb8c364295f316f9c","c8f9763ecdb94812ba842849f35e9760","030cdecb32554688852f97fdc9ea4806","60412776b9ce4194a0565a2bf9bda03f","282ffd7f301245ce8dde3c7e86db0ce1","99436497a509436bab210dc01a29c192","2634c818272f4e85b61ae17dfb125429","bb6f9113ddae4a75b47289463c7992e4","630a67312b7e4fdc99fc8d2efb391d65","10db8c5d400340b393c183943a9e96ca","b7efc26d7428435da0506c51ee07aab2","be40fad6588c4f22892ca7a2e9de5746","6836ee096e5942be8158cea380f0625e","2de91c44ddce4d96be2e9bbf6464e4ac"]},"id":"04VHpjA1UCzA","executionInfo":{"status":"ok","timestamp":1714337772331,"user_tz":240,"elapsed":5139,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"70e15c86-9394-4b52-8882-3bfcd3150233"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/781 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"86bceebc724642fdb3c4a528df349d33"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["pytorch_model.bin:   0%|          | 0.00/439M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"cec02e7e68a34ba29f596bbb3acc9216"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.txt:   0%|          | 0.00/226k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"60412776b9ce4194a0565a2bf9bda03f"}},"metadata":{}}]},{"cell_type":"code","source":["# test\n","pipe = pipeline(\"text-classification\", model=model, tokenizer=tokenizer)\n","results = pipe('Rhonda has been volunteering for several years for a variety of charitable community programs.')"],"metadata":{"id":"DBM1YbDOXxMB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["results"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lCs8RNREX50P","executionInfo":{"status":"ok","timestamp":1714337772332,"user_tz":240,"elapsed":8,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"bf99b552-fc51-43cd-9f3b-ba61be4a5fbe"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[{'label': 'Social', 'score': 0.9906041026115417}]"]},"metadata":{},"execution_count":15}]},{"cell_type":"markdown","source":["At this point, we are ready to test the Llama 2 7b-hf model and see how it performs on our problem without any fine-tuning. This allows us to get insights on the model itself and establish a baseline."],"metadata":{"id":"E7kg_vmmSetS"}},{"cell_type":"code","source":["def label_to_num(inp):\n","    if inp == 'Social':\n","        return 1\n","    else:\n","        return 0"],"metadata":{"id":"M3Ez8HZ8bGfS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Predict\n","text = X_test[\"text\"].to_numpy().astype(str)\n","pipe = pipeline(\"text-classification\", model=model, tokenizer=tokenizer)\n","# pred = useTransformer(text, pipe)"],"metadata":{"id":"P-cLWSqyadrp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Helper for the use of the transformer\n","def useTransformer(arr, classifier):\n","  arr_2 = classifier([x for x in arr])\n","  res = [label_to_num(x['label']) for x in arr_2]\n","  return res\n","\n","pred = useTransformer(text, pipe)"],"metadata":{"id":"OLLUyP8hZqnO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["labels = y_true.to_numpy()"],"metadata":{"id":"8QgU8Gz4cHOJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Create a dictionary mapping strings to integers\n","mapping = {'positive': 1, 'negative': 0}\n","# Use the dictionary to map strings to integers\n","labels = np.vectorize(mapping.get)(labels)"],"metadata":{"id":"Prd0AGLedKVs"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Helper to show output\n","def evaluate(labels, pred, name):\n","  print(\"Evaluation of \" + name)\n","  print(classification_report(labels, pred))\n","  confMat = confusion_matrix(labels, pred)\n","  disp = ConfusionMatrixDisplay(confusion_matrix=confMat, display_labels=[\"no\", \"yes\"])\n","  disp.plot()\n","  plt.show()"],"metadata":{"id":"K5PmppUZbdFe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["evaluate(labels, pred, 'FinBert-ESG on S')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":623},"id":"AfXBBriCb7J9","executionInfo":{"status":"ok","timestamp":1714337807663,"user_tz":240,"elapsed":360,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"30997d13-bfec-4cd4-f15d-1c774f1dd3af"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Evaluation of FinBert-ESG on S\n","              precision    recall  f1-score   support\n","\n","           0       0.71      0.78      0.75       250\n","           1       0.76      0.68      0.72       250\n","\n","    accuracy                           0.73       500\n","   macro avg       0.74      0.73      0.73       500\n","weighted avg       0.74      0.73      0.73       500\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 2 Axes>"],"image/png":"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AgAATtTligJzFAAAgENUFAAAcMJws/VQmysKJAoAADhhSDIM98bXVrQeAACAQ1QUAABwwiqTTKzMCAAAysNTDwAAAOWgogAAgBNWwyQTCy4BAIDyGIabTz3U4sceaD0AAACHqCgAAOBEXZ7MSKIAAIATJAoAAMChujyZkTkKAADAISoKAAA4UZefeiBRAADAiQuJgjtzFDwYTDWj9QAAAByiogAAgBM89QAAABwyftncGV9b0XoAAAAOkSgAAODExdaDO5srduzYocGDB8tsNstkMmndunUOz33ooYdkMpm0ePFiu/25ublKSkpSeHi4IiMjNXr0aBUWFrr82UkUAABwxvDA5oJz586pU6dOWrZs2W+et3btWn322Wcym82XHEtKStI333yjLVu2aOPGjdqxY4fGjh3rWiBijgIAAM65OZlRLo4dOHCgBg4c+JvnZGdna+LEifrggw90yy232B1LT0/X5s2b9cUXX6hbt26SpKVLl2rQoEF6/vnny00sHKGiAABANSkoKLDbiouLK3Udq9Wqe++9V4899pjat29/yfHdu3crMjLSliRIUkJCgnx8fLRnzx6X7kWiAACAExdXZnRnk6TY2FhFRETYtpSUlErF8+yzz8rPz0+TJk0q93hOTo4aNmxot8/Pz09RUVHKyclx6V60HgAAcMJT6yhkZWUpPDzctj8wMNDla+3bt09//OMftX//fplMVb8+AxUFAACqSXh4uN1WmURh586dOnPmjOLi4uTn5yc/Pz99//33evTRR9WsWTNJUkxMjM6cOWM3rqysTLm5uYqJiXHpflQUAABwxjC5PCHxkvEecu+99yohIcFuX2Jiou6991498MADkqT4+Hjl5eVp37596tq1qyTp448/ltVqVY8ePVy6H4kCAABOVPfbIwsLC3XkyBHbz5mZmTpw4ICioqIUFxenBg0a2J3v7++vmJgYtW7dWpLUtm1bDRgwQGPGjNHy5ctVWlqqCRMmaOTIkS498SDRegAAoMbZu3evOnfurM6dO0uSpk6dqs6dO2v27NkVvsbq1avVpk0b9evXT4MGDVLPnj316quvuhwLFQUAAJyp5pc99OnTR4YLZYjjx49fsi8qKkpr1qxx7cblIFEAAMAJ3h7pxPr16yt8wdtuu63SwQAAgJqlQonC0KFDK3Qxk8kki8XiTjwAANRMtfld0W6o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ADhEogAAABwiUQAAAA6RKMCj+vTpo0mTJmn69OmKiopSTEyM5syZYzt+4sQJDRkyRKGhoQoPD9eIESN0+vRp7wUMOJGWlqYGDRqouNj+TbNDhw7VvffeK0l6//331aVLFwUFBalFixaaO3euysp+fbPhnDlzFBcXp8DAQJnNZk2aNKnaPwdQWSQK8Lg33nhDISEh2rNnjxYuXKh58+Zpy5YtslqtGjJkiHJzc7V9+3Zt2bJFx44d01133eXtkAGH7rzzTlksFq1fv96278yZM9q0aZNGjRqlnTt36r777tMjjzyiQ4cOacWKFUpNTdWCBQskSe+++64WLVqkFStW6PDhw1q3bp06dOjgrY8DuIwFl+BRffr0kcVi0c6dO237rr32Wt10003q16+fBg4cqMzMTNsrvg8dOqT27dvr888/V/fu3b0VNvCbxo0bp+PHj+vvf/+7JOnFF1/UsmXLdOTIEd18883q16+fZs6caTv/zTff1PTp03Xy5Em9+OKLWrFihb7++mv5+/t76yMAlUZFAR7XsWNHu58bNWqkM2fOKD09XbGxsbYkQZLatWunyMhIpaenV3eYQIWNGTNGH374obKzsyVJqampuv/++2UymXTw4EHNmzdPoaGhtm3MmDE6deqUzp8/rzvvvFM///yzWrRooTFjxmjt2rW2tgRQG9TZ10yj6vz3b00mk0lWq9VL0QDu69y5szp16qS0tDT1799f33zzjTZt2iRJKiws1Ny5czVs2LBLxgUFBSk2NlYZGRn66KOPtGXLFo0bN07PPfectm/fToUBtQKJAqpN27ZtlZWVpaysLLvWQ15entq1a+fl6IDf9uCDD2rx4sXKzs5WQkKC7c9wly5dlJGRoZYtWzocGxwcrMGDB2vw4MEaP3682rRpo6+++kpdunSprvCBSiNRQLVJSEhQhw4dlJSUpMWLF6usrEzjxo1T79691a1bN2+HB/ymu+++W9OmTdPKlSuVlpZm2z979mzdeuutiouL0x133CEfHx8dPHhQX3/9tebPn6/U1FRZLBb16NFD9erV05tvvqng4GA1bdrUi58GqDjmKKDamEwmvf/++6pfv7569eqlhIQEtWjRQm+//ba3QwOcioiI0PDhwxUaGqqhQ4fa9icmJmrjxo368MMP1b17d1133XVatGiRLRGIjIzUypUrdcMNN6hjx4766KOPtGHDBjVo0MBLnwRwDU89AEAF9evXT+3bt9eSJUu8HQpQbUgUAMCJs2fPatu2bbrjjjt06NAhtW7d2tshAdWGOQoA4ETnzp119uxZPfvssyQJqHOoKAAAAIeYzAgAABwiUQAAAA6RKAAAAIdIFAAAgEMkCgAAwCESBcCL7r//frtV/vr06aPJkydXexzbtm2TyWRSXl6ew3NMJpPWrVtX4WvOmTNH11xzjVtxHT9+XCaTSQcOHHDrOgAqj0QB+C8XXx9sMpkUEBCgli1bat68edXyauD33ntPTz/9dIXOrciXOwC4iwWXgHIMGDBAq1atUnFxsf7+979r/Pjx8vf318yZMy85t6SkRAEBAR65b1RUlEeuAwCeQkUBKEdgYKBiYmLUtGlTPfzww0pISND69esl/douWLBggcxms22lvqysLI0YMUKRkZGKiorSkCFDdPz4cds1LRaLpk6dqsjISDVo0EDTp0/Xf6939t+th+LiYj3++OOKjY1VYGCgWrZsqddff13Hjx9X3759JUn169eXyWTS/fffL0myWq1KSUlR8+bNFRwcrE6dOulvf/ub3X3+/ve/66qrrlJwcLD69u1rF2dFPf7447rqqqtUr149tWjRQrNmzVJpaekl561YsUKxsbGqV6+eRowYofz8fLvjr732mtq2baugoCC1adNGL7/8ssuxAKg6JApABQQHB6ukpMT289atW5WRkaEtW7Zo48aNKi0tVWJiosLCwrRz507985//VGhoqAYMGGAb98ILLyg1NVV/+tOf9Omnnyo3N1dr1679zfved999+stf/qIlS5YoPT1dK1asUGhoqGJjY/Xuu+9KkjIyMnTq1Cn98Y9/lCSlpKQoLS1Ny5cv1zfffKMpU6bonnvu0fbt2yVdSGiGDRumwYMH68CBA3rwwQc1Y8YMl/83CQsLU2pqqg4dOqQ//vGPWrlypRYtWmR3zpEjR/TOO+9ow4YN2rx5s7788kuNGzfOdnz16tWaPXu2FixYoPT0dD3zzDOaNWuW3njjDZfjAVBFDAB2kpOTjSFDhhiGYRhWq9XYsmWLERgYaEybNs12PDo62iguLraN+fOf/2y0bt3asFqttn3FxcVGcHCw8cEHHxiGYRiNGjUyFi5caDteWlpqNGnSxHYvwzCM3r17G4888ohhGIaRkZFhSDK2bNlSbpyffPKJIck4e/asbV9RUZFRr149Y9euXXbnjh492vj9739vGIZhzJw502jXrp3d8ccff/ySa/03ScbatWsdHn/uueeMrl272n5+6qmnDF9fX+OHH36w7fvHP/5h+Pj4GKdOnTIMwzCuvPJKY82aNXbXefrpp434+HjDMAwjMzPTkGR8+eWXDu8LoGoxRwEox8aNGxUaGqrS0lJZrVbdfffdmjNnju14hw4d7OYlHDx4UEeOHFFYWJjddYqKinT06FHl5+fr1KlT6tGjh+2Yn5+funXrdkn74aIDBw7I19dXvXv3rnDcR44c0fnz53XzzTfb7S8pKVHnzp0lSenp6XZxSFJ8fHyF73HR22+/rSVLlujo0aMqLCxUWVmZwsPD7c6Ji4tT48aN7e5jtVqVkZGhsLAwHT16VKNHj9aYMWNs55SVlSkiIsLleABUDRIFoBx9+/bVK6+8ooCAAJnNZvn52f9VCQkJsfu5sLBQXbt21erVqy+51u9+97tKxRAcHOzymMLCQknSpk2b7L6gpQvzLjxl9+7dSkpK0ty5c5WYmKiIiAi99dZbeuGFF1yOdeXKlZckLr6+vh6LFYB7SBSAcoSEhKhly5YVPr9Lly56++231bBhw0t+q76oUaNG2rNnj3r16iXpwm/O+/btU5cuXco9v0OHDrJardq+fbsSEhIuOX6xomGxWGz72rVrp8DAQJ04ccJhJaJt27a2iZkXffbZZ84/5H/YtWuXmjZtqieeeMK27/vvv7/kvBMnTujkyZMym822+/j4+Kh169aKjo6W2WzWsWPHlJSU5NL9AVQfJjMCHpCUlKQrrrhCQ4YM0c6dO5WZmalt27Zp0qRJ+uGHHyRJjzzyiP7whz9o3bp1+vbbbzVu3LjfXAOhWbNmSk5O1qhRo7Ru3TrbNd955x1JUtOmTWUymbRx40b9+OOPKiwsVFhYmKZNm6YpU6bojTfe0NGjR7V//34tXbrUNkHwoYce0uHDh/XYY48pIyNDa9asUWpqqkuft1WrVjpx4oTeeustHT16VEuWLCl3YmZQUJCSk5N18OBB7dy5U5MmTdKIESMUExMjSZo7d65SUlK0ZMkSfffdd/rqq6+0atUqvfjiiy7FA6DqkCgAHlCvXj3t2LFDcXFxGjZsmNq2bavRo0erqKjIVmF49NFHde+99yo5OVnx8fEKCwvT7bff/pvXfeWVV3THHXdo3LhxatOmjcaMGaNz585Jkho3bqy5c+dqxowZio6O1oQJEyRJTz/9tGbNmqWUlBS1bdtWAwYM0KZNm9S8eXNJF+YNvPvuu1q3bp06deqk5cuX65lnnnHp8952222aMmWKJkyYoGuuuUa7du3SrFmzLjmvZcuWGjZsmAYNGqT+/furY8eOdo8/Pvjgg3rttde0atUqdejQQb1791ZqaqotVgDeZzIczaQCAAB1HhUFAADgEIkCAABwiEQBAAA4RKIAAAAcIlEAAAAOkSgAAACHSBQAAIBDJAoAAMAhEgUAAOAQiQIAAHCIRAEAADj0/1NMdccpLAdKAAAAAElFTkSuQmCC\n"},"metadata":{}}]}]}