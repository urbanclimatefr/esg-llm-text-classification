{"metadata":{"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python","version":"3.10.12","mimetype":"text/x-python","codemirror_mode":{"name":"ipython","version":3},"pygments_lexer":"ipython3","nbconvert_exporter":"python","file_extension":".py"},"kaggle":{"accelerator":"gpu","dataSources":[{"sourceId":1192499,"sourceType":"datasetVersion","datasetId":622510},{"sourceId":4295,"sourceType":"modelInstanceVersion","modelInstanceId":3090}],"dockerImageVersionId":30558,"isInternetEnabled":false,"language":"python","sourceType":"notebook","isGpuEnabled":true},"colab":{"provenance":[{"file_id":"https://storage.googleapis.com/kaggle-colab-exported-notebooks/fine-tune-llama-2-for-sentiment-analysis-0b3bc634-17a8-440c-987c-ef532b3e1a94.ipynb?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com/20240428/auto/storage/goog4_request&X-Goog-Date=20240428T151907Z&X-Goog-Expires=259200&X-Goog-SignedHeaders=host&X-Goog-Signature=0d1c4f9d4ac1aa60c4b133a1b651c46b74cf0a71648ffe2c6619b6da7210df275f71da00e7481c1bd781a60e4ac90856230806cba8fa92fc8c0749bacf4014768ffa7ba7ff1e8e3c8a36debb6a63cd349871e75f0ac2aa4e700a72453284791707fc691d9c7d7f2cf59b74a4cf186fdd439d096a15ca89577a0c5384423c39d77ec60202c059f1cd32597cb9974953aa07b1f3230e8a6438044bbd1d694396c7c74e696906fbec420b91322e10764ae0b64d989753d67a381f589f8eadecc8b56a913a77efac2cc687720b68ea225c64f697fc1a2e6518d4296f142188faa3b35ea8ae62fcf2419f64fe12842bb8c125bdbc2dcd0216efa827509f3f2a125c3b","timestamp":1714317558194}],"machine_shape":"hm","gpuType":"L4"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"6941825a470b4eeca1079602b6d3722e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f721aa00653c4fc9bdfad16568af0b86","IPY_MODEL_2cb1f48362c24b06ba07efaae0f9b170","IPY_MODEL_cefb612a5e4f4043bfa3be0db3039976"],"layout":"IPY_MODEL_0baba8b02f4c4d5aaaba12822297fedc"}},"f721aa00653c4fc9bdfad16568af0b86":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b90d148161db4d55aad036e7c0932062","placeholder":"​","style":"IPY_MODEL_a0f72d6e78f944339e258389a587ce51","value":"config.json: 100%"}},"2cb1f48362c24b06ba07efaae0f9b170":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_fa1cfc4e0ee24e9cbbcf15aea2a4f2b5","max":781,"min":0,"orientation":"horizontal","style":"IPY_MODEL_39c5edecc1734a2488eb3a95031ba473","value":781}},"cefb612a5e4f4043bfa3be0db3039976":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5325bc9a07ef4ce398fb4581e1a5d827","placeholder":"​","style":"IPY_MODEL_fd4d83f046fb4691a641b718650c1710","value":" 781/781 [00:00&lt;00:00, 67.6kB/s]"}},"0baba8b02f4c4d5aaaba12822297fedc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b90d148161db4d55aad036e7c0932062":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a0f72d6e78f944339e258389a587ce51":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fa1cfc4e0ee24e9cbbcf15aea2a4f2b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"39c5edecc1734a2488eb3a95031ba473":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5325bc9a07ef4ce398fb4581e1a5d827":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fd4d83f046fb4691a641b718650c1710":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"35a94520c4d5434bb8a6be712f2edd31":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_78bc067b021041bfa99b203de86687d5","IPY_MODEL_a6549a63383143e68554fcff82439ac9","IPY_MODEL_e180bbee334748bfb22b3d88f0a980fa"],"layout":"IPY_MODEL_633d041154c246fba3eb70db7310ce7f"}},"78bc067b021041bfa99b203de86687d5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cc58c204fbba48078682f46c17a1476d","placeholder":"​","style":"IPY_MODEL_1f3d0e00bceb4169b8b75c5122dc486f","value":"pytorch_model.bin: 100%"}},"a6549a63383143e68554fcff82439ac9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_739309258bea4db49ee2b4abc837e57c","max":439107090,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0cb5fbef9897429a9e2cc12d06cc8828","value":439107090}},"e180bbee334748bfb22b3d88f0a980fa":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_fb1735f6f24948b1bf94425eac6313af","placeholder":"​","style":"IPY_MODEL_ce957df8fd874298acd5cac4d8b75df2","value":" 439M/439M [00:07&lt;00:00, 60.4MB/s]"}},"633d041154c246fba3eb70db7310ce7f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cc58c204fbba48078682f46c17a1476d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1f3d0e00bceb4169b8b75c5122dc486f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"739309258bea4db49ee2b4abc837e57c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0cb5fbef9897429a9e2cc12d06cc8828":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"fb1735f6f24948b1bf94425eac6313af":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ce957df8fd874298acd5cac4d8b75df2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"30559d97f21243c8908f479c072e5313":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_640c81095b3341dfafed6830a5d786c0","IPY_MODEL_e4a3bea890234351aebfc89fba8e15ff","IPY_MODEL_505147f13803417d85c4203ce77ee2d0"],"layout":"IPY_MODEL_6a809493c3d44ed5be6ff649e12ef222"}},"640c81095b3341dfafed6830a5d786c0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_52705dd7e3e3402bae5f07d68efba75a","placeholder":"​","style":"IPY_MODEL_5cbf66eb0e6a4e3b8d2979306f90f701","value":"vocab.txt: 100%"}},"e4a3bea890234351aebfc89fba8e15ff":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_58ae6ea564d84f8e9d1525aee9891849","max":226122,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f3639753803341f891c8f06248aa4f9d","value":226122}},"505147f13803417d85c4203ce77ee2d0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_eb5246bfd7ed41e5ba7308557c3247c7","placeholder":"​","style":"IPY_MODEL_acd63ba5f3104a9582cb045567e655ce","value":" 226k/226k [00:00&lt;00:00, 7.04MB/s]"}},"6a809493c3d44ed5be6ff649e12ef222":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"52705dd7e3e3402bae5f07d68efba75a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5cbf66eb0e6a4e3b8d2979306f90f701":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"58ae6ea564d84f8e9d1525aee9891849":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f3639753803341f891c8f06248aa4f9d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"eb5246bfd7ed41e5ba7308557c3247c7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"acd63ba5f3104a9582cb045567e655ce":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat_minor":0,"nbformat":4,"cells":[{"cell_type":"markdown","source":["## Installations and imports"],"metadata":{"id":"UB8_ZM31SetP"}},{"cell_type":"code","source":["!pip install -q -U \"torch==2.1.2\""],"metadata":{"execution":{"iopub.status.busy":"2024-04-26T15:46:51.533318Z","iopub.execute_input":"2024-04-26T15:46:51.534112Z","iopub.status.idle":"2024-04-26T15:51:44.001564Z","shell.execute_reply.started":"2024-04-26T15:46:51.534058Z","shell.execute_reply":"2024-04-26T15:51:43.999504Z"},"trusted":true,"id":"5YeGTE9DSetP","executionInfo":{"status":"ok","timestamp":1714335436914,"user_tz":240,"elapsed":107606,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"8af05244-56fd-408b-d571-9a0ec39ecd66"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m670.2/670.2 MB\u001b[0m \u001b[31m2.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m209.8/209.8 MB\u001b[0m \u001b[31m8.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m89.2/89.2 MB\u001b[0m \u001b[31m9.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","torchaudio 2.2.1+cu121 requires torch==2.2.1, but you have torch 2.1.2 which is incompatible.\n","torchtext 0.17.1 requires torch==2.2.1, but you have torch 2.1.2 which is incompatible.\n","torchvision 0.17.1+cu121 requires torch==2.2.1, but you have torch 2.1.2 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0m"]}]},{"cell_type":"code","source":["!pip install -q -U \"transformers==4.36.2\" \"datasets==2.16.1\" \"accelerate==0.26.1\""],"metadata":{"execution":{"iopub.status.busy":"2024-04-26T16:04:55.495375Z","iopub.execute_input":"2024-04-26T16:04:55.496049Z","iopub.status.idle":"2024-04-26T16:07:25.513833Z","shell.execute_reply.started":"2024-04-26T16:04:55.49599Z","shell.execute_reply":"2024-04-26T16:07:25.512145Z"},"trusted":true,"id":"7zqMMe6RSetP","executionInfo":{"status":"ok","timestamp":1714335453571,"user_tz":240,"elapsed":16661,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"0300e38a-b94a-42e7-cf82-a8e360a76e51"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m8.2/8.2 MB\u001b[0m \u001b[31m27.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m507.1/507.1 kB\u001b[0m \u001b[31m35.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m270.9/270.9 kB\u001b[0m \u001b[31m34.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.6/3.6 MB\u001b[0m \u001b[31m57.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m115.3/115.3 kB\u001b[0m \u001b[31m16.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m194.1/194.1 kB\u001b[0m \u001b[31m27.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m19.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m18.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h"]}]},{"cell_type":"markdown","source":["The code imports the os module and sets two environment variables:\n","* CUDA_VISIBLE_DEVICES: This environment variable tells PyTorch which GPUs to use. In this case, the code is setting the environment variable to 0, which means that PyTorch will use the first GPU.\n","* TOKENIZERS_PARALLELISM: This environment variable tells the Hugging Face Transformers library whether to parallelize the tokenization process. In this case, the code is setting the environment variable to false, which means that the tokenization process will not be parallelized."],"metadata":{"id":"WlDeAXzNSetQ"}},{"cell_type":"code","source":["import os\n","os.environ[\"CUDA_VISIBLE_DEVICES\"] = \"0\"\n","os.environ[\"TOKENIZERS_PARALLELISM\"] = \"false\""],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:32.894556Z","iopub.execute_input":"2024-02-19T15:22:32.894943Z","iopub.status.idle":"2024-02-19T15:22:32.900259Z","shell.execute_reply.started":"2024-02-19T15:22:32.894904Z","shell.execute_reply":"2024-02-19T15:22:32.899115Z"},"trusted":true,"id":"5FqZqYjRSetQ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["The code import warnings; warnings.filterwarnings(\"ignore\") imports the warnings module and sets the warning filter to ignore. This means that all warnings will be suppressed and will not be displayed. Actually during training there are many warnings that do not prevent the fine-tuning but can be distracting and make you wonder if you are doing the correct things."],"metadata":{"id":"7MDuK4_8SetQ"}},{"cell_type":"code","source":["import warnings\n","warnings.filterwarnings(\"ignore\")"],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:32.901507Z","iopub.execute_input":"2024-02-19T15:22:32.90177Z","iopub.status.idle":"2024-02-19T15:22:32.914498Z","shell.execute_reply.started":"2024-02-19T15:22:32.901747Z","shell.execute_reply":"2024-02-19T15:22:32.913622Z"},"trusted":true,"id":"4vEGNQQOSetQ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["In the following cell there are all the other imports for running the notebook"],"metadata":{"id":"e5tzXAWtSetQ"}},{"cell_type":"code","source":["import numpy as np\n","import pandas as pd\n","import os\n","from tqdm import tqdm\n","import torch\n","import torch.nn as nn\n","import transformers\n","from datasets import Dataset\n","from transformers import (AutoModelForCausalLM,\n","                          AutoTokenizer,\n","                          BitsAndBytesConfig,\n","                          TrainingArguments,\n","                          pipeline,\n","                          logging,\n","                          BertTokenizer,\n","                          BertForSequenceClassification\n","                          )\n","from sklearn.metrics import (accuracy_score,\n","                             classification_report,\n","                             confusion_matrix)\n","from sklearn.model_selection import train_test_split"],"metadata":{"papermill":{"duration":14.485002,"end_time":"2023-10-16T11:00:18.917449","exception":false,"start_time":"2023-10-16T11:00:04.432447","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-02-19T15:22:32.915638Z","iopub.execute_input":"2024-02-19T15:22:32.915866Z","iopub.status.idle":"2024-02-19T15:22:48.260443Z","shell.execute_reply.started":"2024-02-19T15:22:32.915846Z","shell.execute_reply":"2024-02-19T15:22:48.259636Z"},"trusted":true,"id":"I8rxnQuGSetR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# standard libraries\n","import matplotlib.pyplot as plt\n","from sklearn.metrics import ConfusionMatrixDisplay"],"metadata":{"id":"jFFZaFgzbpVn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(f\"pytorch version {torch.__version__}\")"],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:48.261986Z","iopub.execute_input":"2024-02-19T15:22:48.262366Z","iopub.status.idle":"2024-02-19T15:22:48.267436Z","shell.execute_reply.started":"2024-02-19T15:22:48.26233Z","shell.execute_reply":"2024-02-19T15:22:48.266395Z"},"trusted":true,"id":"3_jb0ZrUSetR","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1714335461664,"user_tz":240,"elapsed":21,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"513ecc2f-7352-483d-affb-db1103090c2c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["pytorch version 2.1.2+cu121\n"]}]},{"cell_type":"code","source":["device = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\n","print(f\"working on {device}\")"],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:48.268538Z","iopub.execute_input":"2024-02-19T15:22:48.26905Z","iopub.status.idle":"2024-02-19T15:22:48.284682Z","shell.execute_reply.started":"2024-02-19T15:22:48.268983Z","shell.execute_reply":"2024-02-19T15:22:48.283708Z"},"trusted":true,"id":"cydwCB0-SetR","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1714335461664,"user_tz":240,"elapsed":19,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"1139b206-3bbe-4e63-c5ce-fa7d389f1ab6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["working on cuda:0\n"]}]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZmSErehrS7re","executionInfo":{"status":"ok","timestamp":1714335488161,"user_tz":240,"elapsed":26513,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"d98dd10b-8579-41b5-8dc6-6d7f90f029ec"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"markdown","source":["## Preparing the data and the core evaluation functions"],"metadata":{"id":"U4-qApSpSetR"}},{"cell_type":"markdown","source":["The code in the next cell performs the following steps:\n","\n","1. Reads the input dataset from the e_2k.csv file, which is a comma-separated value (CSV) file with two columns: label and text.\n","2. Splits the dataset into training and test sets, with 250 samples in each set. The split is stratified by label, so that each set contains a representative sample of positive, neutral, and negative labels.\n","3. Shuffles the train data in a replicable order (random_state=10)\n","4. Transforms the texts contained in the train and test data into prompts to be used by Llama: the train prompts contains the expected answer we want to fine-tune the model with\n","5. The residual examples not in train or test, for reporting purposes during training (but it won't be used for early stopping), is treated as evaluation data, which is sampled with repetition in order to have a 50/50/50 sample (negative instances are very few, hence they should be repeated)\n","5. The train and eval data are wrapped by the class from Hugging Face (https://huggingface.co/docs/datasets/index)\n","\n","This prepares in a single cell train_data, eval_data and test_data datasets to be used in our fine tuning."],"metadata":{"id":"8fi5OMpiSetR"}},{"cell_type":"code","source":["filename = \"/content/drive/My Drive/Datasets/e_2k.csv\"\n","\n","df = pd.read_csv(filename,\n","                 encoding=\"utf-8\", encoding_errors=\"replace\")\n","# replace values\n","df.replace({'Not Environmental': 'negative', 'Environmental': 'positive'}, inplace=True)\n"],"metadata":{"id":"wRGvCIvYTA69"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X_train = list()\n","X_test = list()\n","for label in [\"positive\", \"negative\"]:\n","    train, test  = train_test_split(df[df.label==label],\n","                                    train_size=250,\n","                                    test_size=250,\n","                                    random_state=42)\n","    X_train.append(train)\n","    X_test.append(test)\n","\n","X_train = pd.concat(X_train).sample(frac=1, random_state=10)\n","X_test = pd.concat(X_test)\n","\n","eval_idx = [idx for idx in df.index if idx not in list(X_train.index) + list(X_test.index)]\n","X_eval = df[df.index.isin(eval_idx)]\n","X_eval = (X_eval\n","          .groupby('label', group_keys=False)\n","          .apply(lambda x: x.sample(n=50, random_state=10, replace=True)))\n","X_train = X_train.reset_index(drop=True)\n","\n","y_true = X_test.label\n","\n","train_data = Dataset.from_pandas(X_train)\n","eval_data = Dataset.from_pandas(X_eval)"],"metadata":{"execution":{"iopub.status.busy":"2024-02-19T15:22:48.28578Z","iopub.execute_input":"2024-02-19T15:22:48.286089Z","iopub.status.idle":"2024-02-19T15:22:48.802257Z","shell.execute_reply.started":"2024-02-19T15:22:48.286056Z","shell.execute_reply":"2024-02-19T15:22:48.80152Z"},"trusted":true,"id":"MKzrGSR0SetR"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Testing the model without fine-tuning"],"metadata":{"id":"66yPJ9CrSetS"}},{"cell_type":"code","source":["!huggingface-cli login"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zSJ21qeQT1tS","executionInfo":{"status":"ok","timestamp":1714335530997,"user_tz":240,"elapsed":42046,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"40adfcf7-1c7d-4b90-e73a-db3f3526caba"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|\n","    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|\n","    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|\n","    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|\n","    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|\n","\n","    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .\n","Token: \n","Add token as git credential? (Y/n) Y\n","Token is valid (permission: write).\n","\u001b[1m\u001b[31mCannot authenticate through git-credential as no helper is defined on your machine.\n","You might have to re-authenticate when pushing to the Hugging Face Hub.\n","Run the following command in your terminal in case you want to set the 'store' credential helper as default.\n","\n","git config --global credential.helper store\n","\n","Read https://git-scm.com/book/en/v2/Git-Tools-Credential-Storage for more details.\u001b[0m\n","Token has not been saved to git credential helper.\n","Your token has been saved to /root/.cache/huggingface/token\n","Login successful\n"]}]},{"cell_type":"code","source":["# Load model from Hugging Face Hub with model name and bitsandbytes configuration\n","\n","model = BertForSequenceClassification.from_pretrained('yiyanghkust/finbert-esg',num_labels=4)\n","tokenizer = BertTokenizer.from_pretrained('yiyanghkust/finbert-esg')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["6941825a470b4eeca1079602b6d3722e","f721aa00653c4fc9bdfad16568af0b86","2cb1f48362c24b06ba07efaae0f9b170","cefb612a5e4f4043bfa3be0db3039976","0baba8b02f4c4d5aaaba12822297fedc","b90d148161db4d55aad036e7c0932062","a0f72d6e78f944339e258389a587ce51","fa1cfc4e0ee24e9cbbcf15aea2a4f2b5","39c5edecc1734a2488eb3a95031ba473","5325bc9a07ef4ce398fb4581e1a5d827","fd4d83f046fb4691a641b718650c1710","35a94520c4d5434bb8a6be712f2edd31","78bc067b021041bfa99b203de86687d5","a6549a63383143e68554fcff82439ac9","e180bbee334748bfb22b3d88f0a980fa","633d041154c246fba3eb70db7310ce7f","cc58c204fbba48078682f46c17a1476d","1f3d0e00bceb4169b8b75c5122dc486f","739309258bea4db49ee2b4abc837e57c","0cb5fbef9897429a9e2cc12d06cc8828","fb1735f6f24948b1bf94425eac6313af","ce957df8fd874298acd5cac4d8b75df2","30559d97f21243c8908f479c072e5313","640c81095b3341dfafed6830a5d786c0","e4a3bea890234351aebfc89fba8e15ff","505147f13803417d85c4203ce77ee2d0","6a809493c3d44ed5be6ff649e12ef222","52705dd7e3e3402bae5f07d68efba75a","5cbf66eb0e6a4e3b8d2979306f90f701","58ae6ea564d84f8e9d1525aee9891849","f3639753803341f891c8f06248aa4f9d","eb5246bfd7ed41e5ba7308557c3247c7","acd63ba5f3104a9582cb045567e655ce"]},"id":"04VHpjA1UCzA","executionInfo":{"status":"ok","timestamp":1714335541828,"user_tz":240,"elapsed":10834,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"035594b0-c881-4ec8-9ad3-1dfe17fd1bd1"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/781 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6941825a470b4eeca1079602b6d3722e"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["pytorch_model.bin:   0%|          | 0.00/439M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"35a94520c4d5434bb8a6be712f2edd31"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.txt:   0%|          | 0.00/226k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"30559d97f21243c8908f479c072e5313"}},"metadata":{}}]},{"cell_type":"code","source":["# test\n","pipe = pipeline(\"text-classification\", model=model, tokenizer=tokenizer)\n","results = pipe('Rhonda has been volunteering for several years for a variety of charitable community programs.')"],"metadata":{"id":"DBM1YbDOXxMB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["results"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lCs8RNREX50P","executionInfo":{"status":"ok","timestamp":1714335756183,"user_tz":240,"elapsed":158,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"2272a741-06e9-40b1-b5ad-b94984fc8bf2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[{'label': 'Social', 'score': 0.9906041026115417}]"]},"metadata":{},"execution_count":18}]},{"cell_type":"markdown","source":["At this point, we are ready to test the Llama 2 7b-hf model and see how it performs on our problem without any fine-tuning. This allows us to get insights on the model itself and establish a baseline."],"metadata":{"id":"E7kg_vmmSetS"}},{"cell_type":"code","source":["def label_to_num(inp):\n","    if inp == 'Environmental':\n","        return 1\n","    else:\n","        return 0"],"metadata":{"id":"M3Ez8HZ8bGfS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Predict\n","text = X_test[\"text\"].to_numpy().astype(str)\n","pipe = pipeline(\"text-classification\", model=model, tokenizer=tokenizer)\n","# pred = useTransformer(text, pipe)"],"metadata":{"id":"P-cLWSqyadrp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Helper for the use of the transformer\n","def useTransformer(arr, classifier):\n","  arr_2 = classifier([x for x in arr])\n","  res = [label_to_num(x['label']) for x in arr_2]\n","  return res\n","\n","pred = useTransformer(text, pipe)"],"metadata":{"id":"OLLUyP8hZqnO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["labels = y_true.to_numpy()"],"metadata":{"id":"8QgU8Gz4cHOJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Create a dictionary mapping strings to integers\n","mapping = {'positive': 1, 'negative': 0}\n","# Use the dictionary to map strings to integers\n","labels = np.vectorize(mapping.get)(labels)"],"metadata":{"id":"Prd0AGLedKVs"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Helper to show output\n","def evaluate(labels, pred, name):\n","  print(\"Evaluation of \" + name)\n","  print(classification_report(labels, pred))\n","  confMat = confusion_matrix(labels, pred)\n","  disp = ConfusionMatrixDisplay(confusion_matrix=confMat, display_labels=[\"no\", \"yes\"])\n","  disp.plot()\n","  plt.show()"],"metadata":{"id":"K5PmppUZbdFe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["evaluate(labels, pred, 'FinBert-ESG on E')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":623},"id":"AfXBBriCb7J9","executionInfo":{"status":"ok","timestamp":1714337170745,"user_tz":240,"elapsed":350,"user":{"displayName":"Tin Yuet Chung","userId":"15907962182928072454"}},"outputId":"062557ad-a132-4f4a-8af5-418e64714c0e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Evaluation of FinBert-ESG on E\n","              precision    recall  f1-score   support\n","\n","           0       0.76      0.96      0.85       250\n","           1       0.95      0.70      0.81       250\n","\n","    accuracy                           0.83       500\n","   macro avg       0.86      0.83      0.83       500\n","weighted avg       0.86      0.83      0.83       500\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 2 Axes>"],"image/png":"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\n"},"metadata":{}}]}]}